# Как работать над проектом

## Окружение

Для удобства работы над проектом используются инструменты из **Node.js** и **npm**. Все необходимые настройки произведены. Убедитесь, что на рабочем компьютере установлен актуальный LTS релиз Node.js**. Актуальная версия **Node.js** указана в файле `package.json` в поле `node`. Затем, в терминале, перейдите в директорию с проектом и _единожды_ запустите команду:

```bash
npm install
```

Команда запустит процесс установки зависимостей проекта из **npm**.

### Переменные окружения

Пример заполнения приведен в файле [.env.example]

| Параметр             | Значение     | Комментарий                                              |
| -------------------- | ------------ | -------------------------------------------------------- |
| **PORT**             | _4000_       | Порт сервера                                             |
| **SALT**             | _secret_     | Случайная строка (соль)                                  |
| **DB_HOST**          | _127.0.0.1_  | IP-адрес для сервера                                     |
| **DB_USER**          | _admin_      | Логин базы данных                                        |
| **DB_PASSWORD**      | _password_   | Пароль базы данных                                       |
| **DB_PORT**          | _27017_      | Порт базы данных                                         |
| **DB_NAME**          | _six-cities_ | Название базы данных                                     |
| **UPLOAD_DIRECTORY** | _upload_     | Директория для загрузки                                  |
| **JWT_SECRET**       | _jwt-key_    | Ключ для JWT                                             |
| **HOST**             | _localhost_  | Хост                                                     |
| **STATIC_DIRECTORY** | _static_     | Директория для файлов статики                            |


## Сценарии

В `package.json` предопределено несколько сценариев.

#### Скомпилировать проект

```bash
npm run compile
```

Создаст директорию `dist` и скомпилирует проект.

#### Удалить скомпилированный проект

```bash
npm run clean
```

Удаляет директорию `dist`. Используется перед компиляцией.

#### Собрать проект

```bash
npm run build
```

Выполняет сборку проекта: удаляет ранее скомпилированный проект и компилирует заново.

#### Проверить линтером

```bash
npm run lint
```

Запуск проверки проекта статическим анализатором кода **ESLint**.

Линтер проверяет файлы только внутри директории `src`.

**Обратите внимание**, при запуске данной команды, ошибки выводятся в терминал.

#### Запустить ts-модуль без компиляции

```bash
npm run ts -- <Путь к модулю с ts-кодом>
```

Пакет `ts-node` позволяет выполнить TS-код в Node.js без предварительной компиляции. Используется только на этапе разработки.

#### Запустить моковый сервер

```bash
npm run mock:server
```

Поднимает сервер, необходимый для генерации данных в CLI-приложении.

#### Скомпилировать и запустить CLI приложение
```bash
nmp run CLI -- [параметры]
```

Выполняет сборку проекта, устанавливает аттрибут исполняемого файла `./dist/main.cli.js` и запускает CLI-приложение c указанными параметрами.

#### Запустить проект в dev-mode

```bash
npm run start:dev
```

Запуск проекта в режиме разработки (без сборки, с перезапуском при изменении *.ts и *.json файлов в директории ./src).

#### Запустить проект

1. Установить пакеты
```bash
npm install
```
2. Поднять докер
```bash
npm run docker:up
```
3. Запустить сервер базы данных
```bash
npm start
```
В процессе запуска проекта будет выполнен процесс «Сборки проекта» и запуска результирующего кода.

Для заполнения базы моковыми данными может быть использовано CLI-приложение. Выполняется в новом терминале.
4. Запускается моковый сервер
```bash
npm run mock:server
```
В новом терминале.
5. Команда для генерации случайных n-предложений
```bash
npm run cli -- --generate 10 ./mocks/mock-data.tsv http://localhost:3123/api
```
6. Команда для импорта сгенерированных предложений в базу
```bash
npm run cli -- --import ./mocks/mock-data.tsv admin password localhost six-cities secret
```


## Структура проекта

### Директория `src`

Исходный код проекта: компоненты, модули и так далее. Структура директории `src` может быть произвольной.

### Файл `Readme.md`

Инструкции по работе с учебным репозиторием.

### Файл `Contributing.md`

Советы и инструкции по внесению изменений в учебный репозиторий.

### Остальное

Все остальные файлы в проекте являются служебными. Пожалуйста, не удаляйте и не изменяйте их самовольно. Только если того требует задание или наставник.
